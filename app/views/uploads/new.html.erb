<%= javascript_include_tag "activestorage" %>

<h1>Upload a .blend file</h1>

<% if @upload.errors.any? %>
  <div class="error-explanation">
    <% @upload.errors.full_messages.each do |message| %>
      <p><%= message %></p>
    <% end %>
  </div>
<% end %>

<%= form_with model: @upload do |form| %>
  <%= form.hidden_field :uuid, value: @upload.uuid %>
  <fieldset>
    <div>
      <%= form.file_field :files,
                      multiple: true,
                      direct_upload: true,
                      data: {
                        direct_upload_url:
                          rails_direct_uploads_url(upload_uuid: @upload.uuid),
                      } %>
    </div>
    <br>
    <% unless authenticated? %>
      <div>
        <%= form.label :guest_email_address, "Email address" %><br>
        <%= form.email_field :guest_email_address,
                         autocomplete: "username",
                         value:
                           params[:guest_email_address] || session[:guest_email_address] %>
      </div>
      <br>
    <% end %>
    <div>
      <%= form.submit %>
    </div>
  </fieldset>
<% end %>
